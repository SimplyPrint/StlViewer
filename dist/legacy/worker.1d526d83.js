!function(){function e(e,r,n){var l=null;switch(e.split(".").pop().split("?")[0].toLowerCase()){case"stl":default:l=t(r);break;case"obj":l=function(e){var t=a(e);function r(e,a,t){return new Array(parseFloat(e),parseFloat(a),parseFloat(t))}function n(e,a){return new Array(parseFloat(e),parseFloat(a))}function l(e){return(e=parseInt(e))>=0?e-1:e+i.length}function o(e,a,t,r){u.push(new Array(l(e),l(a),l(t)))}function d(e,a,t){}function s(e,a,t){void 0===e[3]?(o(e[0],e[1],e[2],t),void 0!==a&&a.length>0&&d(a[0],a[1],a[2])):(void 0!==t&&t.length>0?(o(e[0],e[1],e[3],[t[0],t[1],t[3]]),o(e[1],e[2],e[3],[t[1],t[2],t[3]])):(o(e[0],e[1],e[3]),o(e[1],e[2],e[3])),void 0!==a&&a.length>0&&(d(a[0],a[1],a[3]),d(a[1],a[2],a[3])))}for(var i=[],c=[],f=[],u=[],g=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,p=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,h=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,y=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,v=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,_=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,R=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,b=t.split("\n"),m=0;m<b.length;m++){var w,A=b[m];0!==(A=A.trim()).length&&"#"!==A.charAt(0)&&(null!==(w=g.exec(A))?i.push(r(w[1],w[2],w[3])):null!==(w=p.exec(A))?c.push(r(w[1],w[2],w[3])):null!==(w=h.exec(A))?f.push(n(w[1],w[2])):null!==(w=y.exec(A))?s([w[1],w[2],w[3],w[4]]):null!==(w=v.exec(A))?s([w[2],w[5],w[8],w[11]],[w[3],w[6],w[9],w[12]]):null!==(w=_.exec(A))?s([w[2],w[6],w[10],w[14]],[w[3],w[7],w[11],w[15]],[w[4],w[8],w[12],w[16]]):null!==(w=R.exec(A))&&s([w[2],w[5],w[8],w[11]],[],[w[3],w[6],w[9],w[12]]))}return{vertices:i,faces:u,colors:!1}}(r);break;case"vf":l=function(e){var a=JSON.parse(e),t=[],r=[];try{var n=a.vertices.length;for(i=0;i<n;i++)t.push(new Array(a.vertices[i][0],a.vertices[i][1],a.vertices[i][2]));n=a.faces.length;for(i=0;i<n;i++)r.push(new Array(a.faces[i][0],a.faces[i][1],a.faces[i][2]));return{vertices:t,faces:r,colors:!1}}catch(e){return"ERROR4: "+e.message}}(a(r))}n&&n(l)}function a(e,a,t){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf-8").decode(e);for(var r=new Uint8Array(e),n=r.length,l="",o=0;o<n;o+=16383){var d=16383;o+16383>n&&(d=n-o),l+=String.fromCharCode.apply(null,r.subarray(o,o+d))}return l}function t(e){var t,r,n,l,o,d,s,i=[],c=[],f={},u=!1;if(!e)return null;var g=a(e.slice(0,80)).toLowerCase().indexOf("color"),p=new DataView(e,0),h=!1,y=-1,v=-1,_=-1;g>-1&&(u=!0,y=p.getUint8(g+6,!0)/31,v=p.getUint8(g+7,!0)/31,_=p.getUint8(g+8,!0)/31);var R=80;try{var b=p.getUint32(R,!0)}catch(e){return"ERROR2: "+e.message}var m=84+50*b;if(e.byteLength!=m)return function(e){try{var t=a(e),r=[],n=[],l={};t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\r/,"\n")).replace(/^solid[^\n]*/,"")).replace(/\n/g," ")).replace(/facet normal /g,"")).replace(/outer loop/g,"")).replace(/vertex /g,"")).replace(/endloop/g,"")).replace(/endfacet/g,"")).replace(/endsolid[^\n]*/,"")).replace(/facet/g,"")).replace(/\s+/g," ")).replace(/^\s+/,"");for(var o,d=0,s=t.split(" "),i=[],c=s.length/12-1,f=0;f<c;f++){i=[];for(var u=0;u<3;u++)f1=parseFloat(s[d+3*u+3]),f2=parseFloat(s[d+3*u+4]),f3=parseFloat(s[d+3*u+5]),null==(o=l[[f1,f2,f3]])&&(o=r.length,r.push(new Array(f1,f2,f3)),l[[f1,f2,f3]]=o),i.push(o);n.push(new Array(i[0],i[1],i[2])),d+=12}return{vertices:r,faces:n,colors:!1}}catch(e){return"ERROR1: "+e.message}}(e);try{for(R+=4;b--;){R+=12,null==(t=f[[r=p.getFloat32(R,!0),n=p.getFloat32(R+4,!0),l=p.getFloat32(R+8,!0)]])&&(t=i.length,i.push(new Array(r,n,l)),f[[r,n,l]]=t),o=t,R+=12,null==(t=f[[r=p.getFloat32(R,!0),n=p.getFloat32(R+4,!0),l=p.getFloat32(R+8,!0)]])&&(t=i.length,i.push(new Array(r,n,l)),f[[r,n,l]]=t),d=t,R+=12,null==(t=f[[r=p.getFloat32(R,!0),n=p.getFloat32(R+4,!0),l=p.getFloat32(R+8,!0)]])&&(t=i.length,i.push(new Array(r,n,l)),f[[r,n,l]]=t),s=t,R+=12;var w,A,F,x=p.getUint16(R,!0);if(u?1:(32768&x)>>15)u?32768==x||65535==x?(w=y,A=v,F=_):(h=!0,w=(31&x)/31,A=((992&x)>>5)/31,F=((31744&x)>>10)/31):(h=!0,F=(31&x)/31,A=((992&x)>>5)/31,w=((31744&x)>>10)/31),c.push(new Array(o,d,s,w,A,F));else c.push(new Array(o,d,s));R+=2}return f=null,{vertices:i,faces:c,colors:h}}catch(e){return"ERROR3: "+e.message}}ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,a){if(void 0===e&&(e=0),void 0===a&&(a=this.byteLength),e=Math.floor(e),a=Math.floor(a),e<0&&(e+=this.byteLength),a<0&&(a+=this.byteLength),e=Math.min(Math.max(0,e),this.byteLength),(a=Math.min(Math.max(0,a),this.byteLength))-e<=0)return new ArrayBuffer(0);var t=new ArrayBuffer(a-e),r=new Uint8Array(t),n=new Uint8Array(this,e,a-e);return r.set(n),t});let r=null,n=null,l=null,o=0,d=0,s=0,c=-1,f=!1;function u(e){return!isNaN(parseFloat(e))&&isFinite(e)}function g(e){postMessage({msg_type:2,data:e})}function p(a){let t;if(a)try{t=e(r,a,h)}catch(e){return console.log(e),void g("Error parsing the file")}else g("no data")}function h(e){"string"!=typeof e?postMessage({msg_type:3,vertices:e.vertices,faces:e.faces,colors:e.colors}):g(e)}function y(e){let a=new FileReader;a.onerror=function(e){let a="";switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:a="File not found";break;case e.target.error.NOT_READABLE_ERR:a="Can't read file - too large?";break;case e.target.error.ABORT_ERR:a="Read operation aborted";break;case e.target.error.SECURITY_ERR:a="File is locked";break;case e.target.error.ENCODING_ERR:a="File too large";break;default:a="Error reading file"}g(a)},a.onprogress=function(e){postMessage({msg_type:4,id:c,loaded:e.loaded,total:e.total})},a.onload=function(e){p(e.target.result)},a.readAsArrayBuffer(e)}onmessage=function(e){switch(e.data.msg_type){case 0:if(!e.data.data){g("no data");break}if(!e.data.data.filename&&!e.data.data.local_file){g("no file");break}e.data.data.local_file?(r=e.data.data.local_file.name?e.data.data.local_file.name:e.data.data.filename,n=e.data.data.local_file?e.data.data.local_file:null):e.data.data.filename&&(r=e.data.data.filename),e.data.data.x&&u(e.data.data.x)&&(o=e.data.data.x),e.data.data.y&&u(e.data.data.y)&&(d=e.data.data.y),e.data.data.y&&u(e.data.data.z)&&(s=e.data.data.z),l=null,e.data.load_from_blob_or_ab&&(l=e.data.load_from_blob_or_ab),c=e.data.data.id?e.data.data.id:-1,f=!!e.data.get_progress&&e.data.get_progress;break;case 1:l?l instanceof ArrayBuffer?p(l):y(l):n?y(n):r&&function(e){let a=new XMLHttpRequest;f&&(a.onprogress=function(e){postMessage({msg_type:4,id:c,loaded:e.loaded,total:e.total})}),a.onreadystatechange=function(e){4==a.readyState&&200==a.status&&p(a.response)},a.open("GET",e,!0),a.responseType="arraybuffer",a.send(null)}(r);break;default:console.log("invalid msg: "+e.data.msg_type)}}}();
//# sourceMappingURL=worker.1d526d83.js.map
