!function(){function e(e,r,n){var o=null;switch(e.split(".").pop().split("?")[0].toLowerCase()){case"stl":default:o=t(r);break;case"obj":o=function(e){var t=a(e);function r(e,a,t){return new Array(parseFloat(e),parseFloat(a),parseFloat(t))}function n(e,a){return new Array(parseFloat(e),parseFloat(a))}function o(e){return(e=parseInt(e))>=0?e-1:e+i.length}function l(e,a,t,r){u.push(new Array(o(e),o(a),o(t)))}function d(e,a,t){}function s(e,a,t){void 0===e[3]?(l(e[0],e[1],e[2],t),void 0!==a&&a.length>0&&d(a[0],a[1],a[2])):(void 0!==t&&t.length>0?(l(e[0],e[1],e[3],[t[0],t[1],t[3]]),l(e[1],e[2],e[3],[t[1],t[2],t[3]])):(l(e[0],e[1],e[3]),l(e[1],e[2],e[3])),void 0!==a&&a.length>0&&(d(a[0],a[1],a[3]),d(a[1],a[2],a[3])))}for(var i=[],c=[],f=[],u=[],g=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,p=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,h=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,y=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,v=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,w=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,_=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,m=t.split("\n"),R=0;R<m.length;R++){var b,A=m[R];0!==(A=A.trim()).length&&"#"!==A.charAt(0)&&(null!==(b=g.exec(A))?i.push(r(b[1],b[2],b[3])):null!==(b=p.exec(A))?c.push(r(b[1],b[2],b[3])):null!==(b=h.exec(A))?f.push(n(b[1],b[2])):null!==(b=y.exec(A))?s([b[1],b[2],b[3],b[4]]):null!==(b=v.exec(A))?s([b[2],b[5],b[8],b[11]],[b[3],b[6],b[9],b[12]]):null!==(b=w.exec(A))?s([b[2],b[6],b[10],b[14]],[b[3],b[7],b[11],b[15]],[b[4],b[8],b[12],b[16]]):null!==(b=_.exec(A))&&s([b[2],b[5],b[8],b[11]],[],[b[3],b[6],b[9],b[12]]))}return{vertices:i,faces:u,colors:!1}}(r);break;case"vf":o=function(e){var a=JSON.parse(e),t=[],r=[];try{var n=a.vertices.length;for(i=0;i<n;i++)t.push(new Array(a.vertices[i][0],a.vertices[i][1],a.vertices[i][2]));n=a.faces.length;for(i=0;i<n;i++)r.push(new Array(a.faces[i][0],a.faces[i][1],a.faces[i][2]));return{vertices:t,faces:r,colors:!1}}catch(e){return"ERROR4: "+e.message}}(a(r))}n&&n(o)}function a(e,a,t){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf-8").decode(e);for(var r=new Uint8Array(e),n=r.length,o="",l=0;l<n;l+=16383){var d=16383;l+16383>n&&(d=n-l),o+=String.fromCharCode.apply(null,r.subarray(l,l+d))}return o}function t(e){var t,r,n,o,l,d,s,i=[],c=[],f={},u=!1;if(!e)return null;var g=a(e.slice(0,80)).toLowerCase().indexOf("color"),p=new DataView(e,0),h=!1,y=-1,v=-1,w=-1;g>-1&&(u=!0,y=p.getUint8(g+6,!0)/31,v=p.getUint8(g+7,!0)/31,w=p.getUint8(g+8,!0)/31);var _=80;try{var m=p.getUint32(_,!0)}catch(e){return"ERROR2: "+e.message}var R=84+50*m;if(e.byteLength!=R)return function(e){try{var t=a(e),r=[],n=[],o={};t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\r/,"\n")).replace(/^solid[^\n]*/,"")).replace(/\n/g," ")).replace(/facet normal /g,"")).replace(/outer loop/g,"")).replace(/vertex /g,"")).replace(/endloop/g,"")).replace(/endfacet/g,"")).replace(/endsolid[^\n]*/,"")).replace(/facet/g,"")).replace(/\s+/g," ")).replace(/^\s+/,"");for(var l,d=0,s=t.split(" "),i=[],c=s.length/12-1,f=0;f<c;f++){i=[];for(var u=0;u<3;u++)f1=parseFloat(s[d+3*u+3]),f2=parseFloat(s[d+3*u+4]),f3=parseFloat(s[d+3*u+5]),null==(l=o[[f1,f2,f3]])&&(l=r.length,r.push(new Array(f1,f2,f3)),o[[f1,f2,f3]]=l),i.push(l);n.push(new Array(i[0],i[1],i[2])),d+=12}return{vertices:r,faces:n,colors:!1}}catch(e){return"ERROR1: "+e.message}}(e);try{for(_+=4;m--;){_+=12,null==(t=f[[r=p.getFloat32(_,!0),n=p.getFloat32(_+4,!0),o=p.getFloat32(_+8,!0)]])&&(t=i.length,i.push(new Array(r,n,o)),f[[r,n,o]]=t),l=t,_+=12,null==(t=f[[r=p.getFloat32(_,!0),n=p.getFloat32(_+4,!0),o=p.getFloat32(_+8,!0)]])&&(t=i.length,i.push(new Array(r,n,o)),f[[r,n,o]]=t),d=t,_+=12,null==(t=f[[r=p.getFloat32(_,!0),n=p.getFloat32(_+4,!0),o=p.getFloat32(_+8,!0)]])&&(t=i.length,i.push(new Array(r,n,o)),f[[r,n,o]]=t),s=t,_+=12;var b,A,F,E=p.getUint16(_,!0);if(u?1:(32768&E)>>15)u?32768==E||65535==E?(b=y,A=v,F=w):(h=!0,b=(31&E)/31,A=((992&E)>>5)/31,F=((31744&E)>>10)/31):(h=!0,F=(31&E)/31,A=((992&E)>>5)/31,b=((31744&E)>>10)/31),c.push(new Array(l,d,s,b,A,F));else c.push(new Array(l,d,s));_+=2}return f=null,{vertices:i,faces:c,colors:h}}catch(e){return"ERROR3: "+e.message}}ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,a){if(void 0===e&&(e=0),void 0===a&&(a=this.byteLength),e=Math.floor(e),a=Math.floor(a),e<0&&(e+=this.byteLength),a<0&&(a+=this.byteLength),e=Math.min(Math.max(0,e),this.byteLength),(a=Math.min(Math.max(0,a),this.byteLength))-e<=0)return new ArrayBuffer(0);var t=new ArrayBuffer(a-e),r=new Uint8Array(t),n=new Uint8Array(this,e,a-e);return r.set(n),t});let r=null,n=null,o=null,l=0,d=0,s=0,c=-1,f=!1;function u(e){return!isNaN(parseFloat(e))&&isFinite(e)}function g(e){postMessage({msg_type:2,data:e})}function p(a){let t;if(a)try{t=e(r,a,h)}catch(e){return console.log(e),void g("Error parsing the file")}else g("no data")}function h(e){"string"!=typeof e?postMessage({msg_type:3,vertices:e.vertices,faces:e.faces,colors:e.colors}):g(e)}function y(e){let a=new FileReader;a.onerror=function(e){let a="";switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:a="File not found";break;case e.target.error.NOT_READABLE_ERR:a="Can't read file - too large?";break;case e.target.error.ABORT_ERR:a="Read operation aborted";break;case e.target.error.SECURITY_ERR:a="File is locked";break;case e.target.error.ENCODING_ERR:a="File too large";break;default:a="Error reading file"}g(a)},a.onprogress=function(e){postMessage({msg_type:4,id:c,loaded:e.loaded,total:e.total})},a.onload=function(e){p(e.target.result)},a.readAsArrayBuffer(e)}onmessage=function(e){switch(e.data.msg_type){case 0:if(!e.data.data){g("no data");break}if(!e.data.data.filename&&!e.data.data.local_file){g("no file");break}e.data.data.local_file?(r=e.data.data.local_file.name?e.data.data.local_file.name:e.data.data.filename,n=e.data.data.local_file?e.data.data.local_file:null):e.data.data.filename&&(r=e.data.data.filename),e.data.data.x&&u(e.data.data.x)&&(l=e.data.data.x),e.data.data.y&&u(e.data.data.y)&&(d=e.data.data.y),e.data.data.y&&u(e.data.data.z)&&(s=e.data.data.z),o=null,e.data.load_from_blob_or_ab&&(o=e.data.load_from_blob_or_ab),c=e.data.data.id?e.data.data.id:-1,f=!!e.data.get_progress&&e.data.get_progress;break;case 1:o?o instanceof ArrayBuffer?p(o):y(o):n?y(n):r&&(a=r,fetch?async function(e){const a=await fetch(e,{method:"GET",credentials:"include"});p(await a.arrayBuffer())}(a):function(e){let a=new XMLHttpRequest;f&&(a.onprogress=function(e){postMessage({msg_type:4,id:c,loaded:e.loaded,total:e.total})}),a.onreadystatechange=function(e){4==a.readyState&&200==a.status&&p(a.response)},a.open("GET",e,!0),a.responseType="arraybuffer",a.send(null)}(a));break;default:console.log("invalid msg: "+e.data.msg_type)}var a}}();
//# sourceMappingURL=worker.9b94036b.js.map
